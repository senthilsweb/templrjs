import{d as v,v as B,L as $,K as b,G as y,ak as f,n as D,al as w,k as m,o as N,c as L,u as S}from"./entry.af8fffdd.js";import{p as A}from"./index.288f722b.js";import{h,f as q,a as E}from"./index.749539fc.js";import{u as F}from"./preview.36f54595.js";const g="default",_=/^@|^v-on:/,x=/^:|^v-bind:/,T=/^v-model/,I=["select","textarea","input"],P=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr"].map(t=>[t,`prose-${t}`])),V=v({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},excerpt:{type:Boolean,default:!1},tag:{type:String,default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})}},async setup(t){var o,r;const{mdc:e}=B().public,n={...e.components.prose&&t.prose!==!1?P:{},...e.components.map,...$(((r=(o=t.data)==null?void 0:o.mdc)==null?void 0:r.components)||{}),...t.components};return await Y(t.body,{tags:n}),{tags:n}},render(t){var c,u;const{tags:e,tag:n,body:o,data:r}=t;if(!o)return null;const s={...r,tags:e};let i=n||((c=s.component)==null?void 0:c.name)||s.component||"div";return i=O(i),b(i,{...(u=s.component)==null?void 0:u.props,...this.$attrs},C(o,b,s,s))}});function W(t,e,n,o={}){var u;if(t.type==="text")return e(f,t.value);if(t.tag==="script")return e(f,j(t));const r=t.tag,s=typeof((u=t.props)==null?void 0:u.__ignoreMap)>"u"&&n.tags[r]||r;if(t.tag==="binding")return z(t,e,n,o);const i=O(s);typeof i=="object"&&(i.tag=r);const c=G(t,n);return e(i,c,C(t,e,n,{...o,...c}))}function j(t){var e,n;return t.type==="text"?t.value:(e=t.children)!=null&&e.length?`<${t.tag}>${((n=t.children)==null?void 0:n.map(j).join(""))||""}</${t.tag}>`:`<${t.tag}>`}function z(t,e,n,o={}){var u;const r={...o,$route:()=>D(),$document:n,$doc:n},s=/\.|\[(\d+)\]/,c=((u=t.props)==null?void 0:u.value.trim().split(s).filter(Boolean)).reduce((p,l)=>l in p?typeof p[l]=="function"?p[l]():p[l]:{},r);return e(f,c)}function C(t,e,n,o){const s=(t.children||[]).reduce((c,u)=>{if(!Q(u))return c[g].push(u),c;const p=M(u);return c[p]=c[p]||[],u.type==="element"&&c[p].push(...u.children||[]),c},{[g]:[]});return Object.entries(s).reduce((c,[u,p])=>(p.length&&(c[u]=()=>{const l=p.map(a=>W(a,e,n,o));return X(l)}),c),{})}function G(t,e){const{tag:n="",props:o={}}=t;return Object.keys(o).reduce(function(r,s){if(s==="__ignoreMap")return r;const i=o[s];if(T.test(s)&&!I.includes(n))return K(s,i,r,e);if(s==="v-bind")return U(s,i,r,e);if(_.test(s))return H(s,i,r,e);if(x.test(s))return J(s,i,r,e);const{attribute:c}=q(E,s);return Array.isArray(i)&&i.every(u=>typeof u=="string")?(r[c]=i.join(" "),r):(r[c]=i,r)},{})}function K(t,e,n,o){const r=a=>+a,s=a=>a.trim(),i=a=>a,c=t.replace(T,"").split(".").filter(a=>a).reduce((a,R)=>(a[R]=!0,a),{}),u="value",p=c.lazy?"change":"input",l=c.number?r:c.trim?s:i;return n[u]=d(e,o),n.on=n.on||{},n.on[p]=a=>o[e]=l(a),n}function U(t,e,n,o){const r=d(e,o);return n=Object.assign(n,r),n}function H(t,e,n,o){return t=t.replace(_,""),n.on=n.on||{},n.on[t]=()=>d(e,o),n}function J(t,e,n,o){return t=t.replace(x,""),n[t]=d(e,o),n}const O=t=>{if(!h.includes(t)&&!(t!=null&&t.render)){const e=y(A(t),!1);if(typeof e=="object")return e}return t};function d(t,e){const n=t.split(".").reduce((o,r)=>typeof o=="object"?o[r]:void 0,e);return typeof n>"u"?w(t):n}function M(t){let e="";for(const n of Object.keys(t.props||{}))if(!(!n.startsWith("#")&&!n.startsWith("v-slot:"))){e=n.split(/[:#]/,2)[1];break}return e||g}function Q(t){return t.tag==="template"}function X(t){const e=[];for(const n of t){const o=e[e.length-1];n.type===f&&(o==null?void 0:o.type)===f?o.children=o.children+n.children:e.push(n)}return e}async function Y(t,e){const n=Array.from(new Set(o(t,e)));await Promise.all(n.map(async r=>{if(r!=null&&r.render||r!=null&&r.ssrRender)return;const s=y(r);s!=null&&s.__asyncLoader&&!s.__asyncResolved&&await s.__asyncLoader()}));function o(r,s){var p;const i=r.tag;if(r.type==="text"||i==="binding")return[];const c=typeof((p=r.props)==null?void 0:p.__ignoreMap)>"u"&&s.tags[i]||i,u=[];r.type!=="root"&&!h.includes(c)&&u.push(c);for(const l of r.children||[])u.push(...o(l,s));return u}}const nt=v({__name:"ContentRendererMarkdown",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})}},setup(t){const e=t,n=F().isEnabled(),o=m(()=>{let i=e.value.body||e.value;return e.excerpt&&e.value.excerpt&&(i=e.value.excerpt),i}),r=m(()=>{const{body:i,excerpt:c,...u}=e.value;return u}),s=m(()=>({...e.components,...r.value._components||{}}));return(i,c)=>{const u=V;return N(),L(u,{body:o.value,data:r.value,tag:t.tag,components:s.value,"data-content-id":S(n)?t.value._id:void 0},null,8,["body","data","tag","components","data-content-id"])}}});export{nt as _};
